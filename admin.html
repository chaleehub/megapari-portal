<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin â€” Megapari Portal</title>
<link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<style>
  :root{
    --green:#00e676;--green2:#00c853;--dark:#080c0a;--dark2:#0d1410;
    --card:#111a14;--card2:#162019;--border:rgba(0,230,118,0.15);
    --text:#e8f5e9;--muted:#7a9e85;--red:#ff5252;--amber:#ffab40;
  }
  *{margin:0;padding:0;box-sizing:border-box;}
  body{background:var(--dark);color:var(--text);font-family:'Outfit',sans-serif;min-height:100vh;}
  body::before{content:'';position:fixed;inset:0;background:radial-gradient(ellipse at 20% 20%,rgba(0,230,118,0.05) 0%,transparent 50%);pointer-events:none;z-index:0;}

  .admin-wrap{display:flex;min-height:100vh;position:relative;z-index:1;}
  .sidebar{
    width:230px;background:var(--card);border-right:1px solid var(--border);
    padding:24px 0;flex-shrink:0;position:fixed;top:0;left:0;height:100vh;overflow-y:auto;z-index:10;
  }
  .sidebar-logo{padding:0 20px 24px;border-bottom:1px solid var(--border);margin-bottom:12px;}
  .logo-text{font-family:'Bebas Neue',sans-serif;font-size:1.6rem;color:var(--green);letter-spacing:2px;}
  .logo-sub{font-size:.62rem;color:var(--muted);letter-spacing:2px;text-transform:uppercase;margin-top:2px;}
  .nav-item{
    display:flex;align-items:center;gap:10px;padding:13px 20px;cursor:pointer;
    font-size:.87rem;font-weight:500;color:var(--muted);transition:all .15s;
    border-left:3px solid transparent;user-select:none;
  }
  .nav-item:hover{color:var(--text);background:rgba(0,230,118,0.05);}
  .nav-item.active{color:var(--green);border-left-color:var(--green);background:rgba(0,230,118,0.08);}
  .nav-sep{height:1px;background:var(--border);margin:8px 0;}

  .main{flex:1;margin-left:230px;padding:32px 36px;overflow-y:auto;min-height:100vh;}
  .page{display:none;}
  .page.active{display:block;}

  .page-header{margin-bottom:28px;padding-bottom:16px;border-bottom:1px solid var(--border);}
  .page-header h1{font-family:'Bebas Neue',sans-serif;font-size:2.2rem;letter-spacing:4px;color:var(--text);}
  .page-header p{color:var(--muted);font-size:.85rem;margin-top:5px;}

  .card{background:var(--card);border:1px solid var(--border);border-radius:14px;padding:24px;margin-bottom:22px;}
  .card h3{font-size:.82rem;font-weight:700;margin-bottom:18px;color:var(--green);text-transform:uppercase;letter-spacing:2px;display:flex;align-items:center;gap:8px;}

  .form-row{display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:14px;margin-bottom:14px;}
  .form-group{display:flex;flex-direction:column;gap:6px;}
  label{font-size:.7rem;text-transform:uppercase;letter-spacing:1.5px;color:var(--muted);font-weight:600;}
  input[type=text],input[type=date],input[type=number],input[type=password],select,textarea{
    background:#0a1209;border:1px solid var(--border);border-radius:8px;
    color:var(--text);padding:11px 14px;font-family:'Outfit',sans-serif;font-size:.88rem;
    outline:none;transition:border-color .2s;width:100%;
  }
  input[type=color]{background:#0a1209;border:1px solid var(--border);border-radius:8px;height:42px;padding:4px 8px;width:100%;cursor:pointer;}
  input:focus,select:focus,textarea:focus{border-color:var(--green);}
  textarea{resize:vertical;min-height:120px;line-height:1.6;}

  .btn{padding:10px 20px;border:none;border-radius:8px;font-family:'Outfit',sans-serif;font-size:.83rem;font-weight:700;cursor:pointer;transition:all .2s;letter-spacing:.5px;display:inline-flex;align-items:center;gap:6px;}
  .btn-green{background:var(--green);color:#000;}
  .btn-green:hover{background:var(--green2);transform:translateY(-1px);}
  .btn-red{background:rgba(255,82,82,0.12);color:var(--red);border:1px solid rgba(255,82,82,0.25);}
  .btn-red:hover{background:rgba(255,82,82,0.22);}
  .btn-amber{background:rgba(255,171,64,0.12);color:var(--amber);border:1px solid rgba(255,171,64,0.25);}
  .btn-amber:hover{background:rgba(255,171,64,0.22);}
  .btn-outline{background:transparent;color:var(--green);border:1px solid rgba(0,230,118,0.4);}
  .btn-outline:hover{background:rgba(0,230,118,0.08);}
  .btn-sm{padding:5px 12px;font-size:.74rem;}
  .btn-row{display:flex;gap:10px;flex-wrap:wrap;align-items:center;}

  .table-wrap{overflow-x:auto;}
  table{width:100%;border-collapse:collapse;font-size:.83rem;}
  th{padding:10px 14px;background:var(--card2);color:var(--muted);text-align:left;font-weight:700;font-size:.68rem;text-transform:uppercase;letter-spacing:1.5px;}
  td{padding:11px 14px;border-bottom:1px solid rgba(0,230,118,0.06);vertical-align:middle;}
  tr:last-child td{border-bottom:none;}
  tr:hover td{background:rgba(0,230,118,0.02);}

  .badge{display:inline-block;padding:3px 9px;border-radius:4px;font-size:.68rem;font-weight:700;letter-spacing:.5px;}
  .badge-green{background:rgba(0,230,118,0.1);color:var(--green);border:1px solid rgba(0,230,118,0.2);}
  .badge-amber{background:rgba(255,171,64,0.1);color:var(--amber);border:1px solid rgba(255,171,64,0.2);}
  .badge-blue{background:rgba(100,181,246,0.1);color:#90caf9;border:1px solid rgba(100,181,246,0.2);}

  /* BANNER PREVIEW */
  .preview-wrap{
    width:100%;background:#060e08;border:2px dashed rgba(0,230,118,0.25);border-radius:10px;
    min-height:200px;display:flex;align-items:center;justify-content:center;
    position:relative;overflow:hidden;user-select:none;margin-bottom:8px;
  }
  .preview-wrap.has-image{cursor:crosshair;border-style:solid;border-color:rgba(0,230,118,0.35);}
  #preview-canvas{display:none;max-width:100%;}
  .promo-overlay{position:absolute;border:2px solid var(--green);pointer-events:none;background:rgba(0,230,118,0.15);display:none;}
  .preview-placeholder{text-align:center;color:var(--muted);padding:40px 20px;}
  .preview-placeholder .icon{font-size:3rem;margin-bottom:10px;opacity:.4;}

  /* EXCEL */
  .upload-box{border:2px dashed rgba(0,230,118,0.25);border-radius:10px;padding:28px;text-align:center;background:rgba(0,230,118,0.02);transition:all .2s;cursor:pointer;}
  .upload-box:hover{border-color:var(--green);background:rgba(0,230,118,0.05);}
  .upload-box .icon{font-size:2.5rem;margin-bottom:8px;}
  .upload-box p{color:var(--muted);font-size:.85rem;line-height:1.6;}
  .upload-box strong{color:var(--green);}

  .import-preview{background:#0a1209;border:1px solid var(--border);border-radius:8px;padding:14px;margin-top:14px;max-height:220px;overflow-y:auto;}
  .import-preview table{font-size:.78rem;}
  .import-preview th{background:#0d1a10;padding:7px 10px;}
  .import-preview td{padding:7px 10px;}

  /* FILTER TABS */
  .filter-tabs{display:flex;gap:6px;flex-wrap:wrap;margin-bottom:16px;}
  .filter-tab{padding:6px 14px;border-radius:20px;font-size:.75rem;font-weight:600;cursor:pointer;border:1px solid var(--border);color:var(--muted);transition:all .15s;background:transparent;font-family:'Outfit',sans-serif;}
  .filter-tab:hover{border-color:var(--green);color:var(--green);}
  .filter-tab.active{background:var(--green);color:#000;border-color:var(--green);}

  /* TEXT CARDS */
  .text-admin-card{background:var(--card2);border:1px solid var(--border);border-radius:10px;padding:16px;margin-bottom:12px;transition:border-color .2s;}
  .text-admin-card:hover{border-color:rgba(0,230,118,0.3);}
  .text-admin-card .card-top{display:flex;align-items:center;justify-content:space-between;margin-bottom:10px;gap:10px;flex-wrap:wrap;}
  .text-admin-card pre{white-space:pre-wrap;font-family:'Outfit',sans-serif;font-size:.82rem;color:var(--text);line-height:1.65;max-height:120px;overflow:hidden;position:relative;}
  .text-admin-card pre::after{content:'';position:absolute;bottom:0;left:0;right:0;height:28px;background:linear-gradient(transparent,var(--card2));}

  /* INFO BOX */
  .info-box{background:rgba(0,230,118,0.04);border:1px solid rgba(0,230,118,0.18);border-radius:8px;padding:12px 16px;font-size:.82rem;color:var(--muted);margin-bottom:14px;line-height:1.7;}
  .info-box strong{color:var(--green);}

  /* LOGIN */
  #login-screen{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:var(--dark);z-index:999;}
  .login-card{background:var(--card);border:1px solid var(--border);border-radius:18px;padding:44px;width:100%;max-width:400px;text-align:center;box-shadow:0 20px 60px rgba(0,0,0,.5);}
  .login-logo{font-family:'Bebas Neue',sans-serif;font-size:2.6rem;letter-spacing:3px;margin-bottom:4px;}
  .login-sub{font-size:.85rem;color:var(--muted);margin-bottom:32px;letter-spacing:1px;}
  .login-error{color:var(--red);font-size:.8rem;margin-bottom:10px;padding:8px 12px;background:rgba(255,82,82,0.1);border-radius:6px;display:none;}

  /* TOAST */
  #admin-toast{position:fixed;bottom:28px;right:28px;z-index:9999;padding:11px 22px;border-radius:30px;font-weight:700;font-size:.85rem;opacity:0;transform:translateY(12px);transition:all .3s;pointer-events:none;}
  #admin-toast.show{opacity:1;transform:translateY(0);}

  .drag-hint{font-size:.75rem;color:var(--amber);display:none;gap:6px;align-items:center;margin-bottom:14px;}
  .drag-hint.show{display:flex;}

  @media(max-width:800px){.sidebar{width:200px;}.main{margin-left:200px;padding:20px;}}
  @media(max-width:600px){.admin-wrap{flex-direction:column;}.sidebar{position:relative;width:100%;height:auto;}.main{margin-left:0;}}
</style>
</head>
<body>

<!-- LOGIN -->
<div id="login-screen">
  <div class="login-card">
    <div class="login-logo"><span style="color:var(--green)">MEGA</span><span style="color:var(--text)">PARI</span></div>
    <div class="login-sub">Admin Panel</div>
    <div class="form-group" style="text-align:left;margin-bottom:14px;">
      <label>Password</label>
      <input type="password" id="pw-input" placeholder="Enter admin password" onkeydown="if(event.key==='Enter')doLogin()"/>
    </div>
    <div class="login-error" id="login-error">âŒ Incorrect password. Please try again.</div>
    <button class="btn btn-green" style="width:100%;justify-content:center;padding:13px" onclick="doLogin()">ENTER ADMIN â†’</button>
    <p style="margin-top:16px;font-size:.72rem;color:var(--muted)">Default password: <strong style="color:var(--text)">admin123</strong></p>
  </div>
</div>

<!-- ADMIN PANEL -->
<div class="admin-wrap" id="admin-panel" style="display:none">
  <nav class="sidebar">
    <div class="sidebar-logo">
      <div class="logo-text">MEGA<span style="color:var(--text)">PARI</span></div>
      <div class="logo-sub">Admin Panel</div>
    </div>
    <div class="nav-item active" onclick="showPage('affiliates',this)">ğŸ‘¥ Affiliates</div>
    <div class="nav-item" onclick="showPage('banners',this)">ğŸ–¼ï¸ Banners</div>
    <div class="nav-item" onclick="showPage('texts',this)">âœï¸ Post Captions</div>
    <div class="nav-sep"></div>
    <div class="nav-item" onclick="showPage('settings',this)">âš™ï¸ Settings</div>
    <div class="nav-item" onclick="window.open('index.html','_blank')">ğŸ”— View Portal</div>
    <div class="nav-item" onclick="doLogout()">ğŸšª Logout</div>
  </nav>

  <main class="main">

    <!-- â•â• AFFILIATES â•â• -->
    <div class="page active" id="page-affiliates">
      <div class="page-header">
        <h1>ğŸ‘¥ AFFILIATES</h1>
        <p>Add single affiliates or bulk-import from Excel/spreadsheet</p>
      </div>

      <div class="card">
        <h3>â• <span id="aff-form-title">Add Single Affiliate</span></h3>
        <input type="hidden" id="edit-aff-original-id">
        <div class="form-row">
          <div class="form-group">
            <label>Affiliate ID *</label>
            <input type="text" id="aff-id" placeholder="e.g. AFF12345"/>
          </div>
          <div class="form-group">
            <label>Display Name</label>
            <input type="text" id="aff-name" placeholder="e.g. John Doe"/>
          </div>
          <div class="form-group">
            <label>Promo Code *</label>
            <input type="text" id="aff-promo" placeholder="e.g. JOHN50"/>
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label>Player / Referral Link</label>
            <input type="text" id="aff-player" placeholder="https://..."/>
          </div>
          <div class="form-group">
            <label>Android APK Link</label>
            <input type="text" id="aff-apk" placeholder="https://..."/>
          </div>
          <div class="form-group">
            <label>iOS App Link</label>
            <input type="text" id="aff-ios" placeholder="https://..."/>
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label>Preferred Language</label>
            <select id="aff-lang">
              <option value="en">English</option>
              <option value="fr">French</option>
              <option value="ar">Arabic</option>
              <option value="es">Spanish</option>
              <option value="pt">Portuguese</option>
            </select>
          </div>
        </div>
        <div class="btn-row">
          <button class="btn btn-green" onclick="saveAffiliate()">ğŸ’¾ Save Affiliate</button>
          <button class="btn btn-outline" onclick="clearAffForm()">âœ• Clear Form</button>
        </div>
      </div>

      <!-- Excel Import -->
      <div class="card">
        <h3>ğŸ“Š Bulk Import from Excel</h3>
        <div class="info-box">
          Your Excel columns should be in this exact order:<br>
          <strong>Column A:</strong> Affiliate ID &nbsp;|&nbsp; <strong>B:</strong> Name &nbsp;|&nbsp; <strong>C:</strong> Promo Code &nbsp;|&nbsp; <strong>D:</strong> Player Link &nbsp;|&nbsp; <strong>E:</strong> APK Link &nbsp;|&nbsp; <strong>F:</strong> iOS Link &nbsp;|&nbsp; <strong>G:</strong> Language (en / fr / ar / es / pt)<br>
          The first row can be a header row â€” it will be skipped automatically.
        </div>
        <div class="upload-box" onclick="document.getElementById('excel-input').click()">
          <div class="icon">ğŸ“‚</div>
          <p><strong>Click here to choose your Excel file</strong><br>Supports .xlsx and .xls formats</p>
        </div>
        <input type="file" id="excel-input" accept=".xlsx,.xls" style="display:none" onchange="handleExcelImport()"/>
        <div id="excel-preview" style="display:none">
          <div style="display:flex;align-items:center;justify-content:space-between;margin-top:16px;flex-wrap:wrap;gap:10px;">
            <span id="excel-count" style="color:var(--green);font-weight:700;font-size:.9rem;"></span>
            <div class="btn-row">
              <button class="btn btn-green btn-sm" onclick="confirmExcelImport()">âœ… Confirm Import</button>
              <button class="btn btn-red btn-sm" onclick="cancelExcelImport()">âœ• Cancel</button>
            </div>
          </div>
          <div class="import-preview" id="excel-preview-table"></div>
        </div>
      </div>

      <!-- Table -->
      <div class="card">
        <h3>ğŸ“‹ All Affiliates â€” <span id="aff-count" style="color:var(--text)">0</span> total</h3>
        <div class="table-wrap">
          <table>
            <thead><tr><th>Affiliate ID</th><th>Name</th><th>Promo Code</th><th>Language</th><th>Links</th><th>Actions</th></tr></thead>
            <tbody id="aff-tbody"></tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- â•â• BANNERS â•â• -->
    <div class="page" id="page-banners">
      <div class="page-header">
        <h1>ğŸ–¼ï¸ BANNERS</h1>
        <p>Upload banners, set date ranges, and define the promo code area</p>
      </div>

      <div class="card">
        <h3>â¬†ï¸ Upload New Banner</h3>
        <div class="form-row">
          <div class="form-group">
            <label>Language *</label>
            <select id="ban-lang">
              <option value="en">English</option>
              <option value="fr">French</option>
              <option value="ar">Arabic</option>
              <option value="es">Spanish</option>
              <option value="pt">Portuguese</option>
            </select>
          </div>
          <div class="form-group">
            <label>Banner Type *</label>
            <select id="ban-type" onchange="toggleDates()">
              <option value="dated">ğŸ“… Dated (has expiry)</option>
              <option value="evergreen">â™¾ï¸ Evergreen (no expiry)</option>
            </select>
          </div>
          <div class="form-group" id="start-grp">
            <label>Start Date</label>
            <input type="date" id="ban-start"/>
          </div>
          <div class="form-group" id="end-grp">
            <label>End Date</label>
            <input type="date" id="ban-end"/>
          </div>
        </div>

        <div class="form-group" style="margin-bottom:16px">
          <label>Upload Image File (PNG / JPG) *</label>
          <input type="file" id="ban-file" accept="image/*" onchange="loadBannerPreview()"
            style="background:transparent;border:1px dashed rgba(0,230,118,0.3);padding:12px;border-radius:8px;color:var(--muted);cursor:pointer;"/>
        </div>

        <label style="margin-bottom:8px;display:block">Banner Preview â€” Drag to mark Promo Code area</label>
        <div class="preview-wrap" id="preview-wrap">
          <div class="preview-placeholder" id="preview-placeholder">
            <div class="icon">ğŸ–¼ï¸</div>
            <p>Upload an image above to see the preview here</p>
          </div>
          <canvas id="preview-canvas"></canvas>
          <div class="promo-overlay" id="promo-overlay"></div>
        </div>
        <div class="drag-hint" id="drag-hint">âš¡ Click and drag on the image above to mark where the promo code will appear</div>

        <div id="promo-config-panel" style="display:none;margin-bottom:16px;">
          <div style="background:rgba(0,230,118,0.04);border:1px solid rgba(0,230,118,0.2);border-radius:8px;padding:16px;">
            <p style="font-size:.75rem;color:var(--green);font-weight:700;text-transform:uppercase;letter-spacing:1px;margin-bottom:14px;">âœ… Promo Code Zone Selected â€” Adjust styling below</p>
            <div class="form-row">
              <div class="form-group">
                <label>Font Size (px)</label>
                <input type="number" id="pc-size" value="28" min="8" max="120"/>
              </div>
              <div class="form-group">
                <label>Text Color</label>
                <input type="color" id="pc-color" value="#ffffff"/>
              </div>
              <div class="form-group">
                <label>Zone Position</label>
                <input type="text" id="pc-zone-info" readonly placeholder="Drag to set" style="cursor:default;font-size:.78rem;"/>
              </div>
            </div>
          </div>
        </div>

        <div class="btn-row">
          <button class="btn btn-green" onclick="saveBanner()">ğŸ’¾ Save Banner</button>
          <button class="btn btn-outline" onclick="clearBannerForm()">âœ• Clear</button>
        </div>
      </div>

      <div class="card">
        <h3>ğŸ“‹ All Banners â€” <span id="ban-count" style="color:var(--text)">0</span> total</h3>
        <div class="table-wrap">
          <table>
            <thead><tr><th>Preview</th><th>Type</th><th>Language</th><th>Date Range</th><th>Promo Zone</th><th>Actions</th></tr></thead>
            <tbody id="ban-tbody"></tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- â•â• TEXTS â•â• -->
    <div class="page" id="page-texts">
      <div class="page-header">
        <h1>âœï¸ POST CAPTIONS</h1>
        <p>Add, edit, and manage all caption templates across all languages â€” 7 per language by default</p>
      </div>

      <div class="card">
        <h3><span id="txt-form-icon">â•</span> <span id="txt-form-title">Add New Caption</span></h3>
        <input type="hidden" id="edit-text-id">
        <div class="info-box">
          Insert these placeholders â€” they are automatically replaced with the affiliate's details:<br>
          <strong>{{Player link}}</strong> &nbsp;Â·&nbsp; <strong>{{apk link}}</strong> &nbsp;Â·&nbsp; <strong>{{iOS link}}</strong> &nbsp;Â·&nbsp; <strong>{{Promo code}}</strong>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label>Language *</label>
            <select id="txt-lang">
              <option value="en">English</option>
              <option value="fr">French</option>
              <option value="ar">Arabic</option>
              <option value="es">Spanish</option>
              <option value="pt">Portuguese</option>
            </select>
          </div>
        </div>
        <div class="form-group" style="margin-bottom:16px">
          <label>Caption Text</label>
          <textarea id="txt-content" rows="9" placeholder="Type your caption here..."></textarea>
        </div>
        <div class="btn-row">
          <button class="btn btn-green" onclick="saveText()">ğŸ’¾ Save Caption</button>
          <button class="btn btn-outline" onclick="clearTextForm()">âœ• Clear</button>
          <span id="txt-edit-note" style="display:none;font-size:.78rem;color:var(--amber)">âœï¸ Editing existing caption â€” click Save to update it</span>
        </div>
      </div>

      <div class="card">
        <h3>ğŸ“‹ All Captions â€” <span id="txt-count" style="color:var(--text)">0</span> total</h3>
        <div class="filter-tabs">
          <button class="filter-tab active" onclick="filterTexts('all',this)">All</button>
          <button class="filter-tab" onclick="filterTexts('en',this)">ğŸ‡¬ğŸ‡§ English</button>
          <button class="filter-tab" onclick="filterTexts('fr',this)">ğŸ‡«ğŸ‡· French</button>
          <button class="filter-tab" onclick="filterTexts('ar',this)">ğŸ‡¸ğŸ‡¦ Arabic</button>
          <button class="filter-tab" onclick="filterTexts('es',this)">ğŸ‡ªğŸ‡¸ Spanish</button>
          <button class="filter-tab" onclick="filterTexts('pt',this)">ğŸ‡§ğŸ‡· Portuguese</button>
        </div>
        <div id="texts-admin-list"></div>
      </div>
    </div>

    <!-- â•â• SETTINGS â•â• -->
    <div class="page" id="page-settings">
      <div class="page-header">
        <h1>âš™ï¸ SETTINGS</h1>
        <p>Change your admin password and manage all portal data</p>
      </div>

      <div class="card">
        <h3>ğŸ” Change Admin Password</h3>
        <div class="form-row">
          <div class="form-group">
            <label>Current Password</label>
            <input type="password" id="cur-pw" placeholder="Your current password"/>
          </div>
          <div class="form-group">
            <label>New Password</label>
            <input type="password" id="new-pw" placeholder="Minimum 4 characters"/>
          </div>
          <div class="form-group">
            <label>Confirm New Password</label>
            <input type="password" id="conf-pw" placeholder="Repeat new password"/>
          </div>
        </div>
        <button class="btn btn-green" onclick="changePassword()">ğŸ”’ Update Password</button>
      </div>

      <div class="card">
        <h3>ğŸ’¾ Data Backup &amp; Restore</h3>
        <p style="color:var(--muted);font-size:.85rem;line-height:1.7;margin-bottom:18px">
          All data is saved in your browser's local storage. Export regularly as a backup file.
          Use Import to restore data or move it to a different browser or device.
        </p>
        <div class="btn-row">
          <button class="btn btn-green" onclick="exportData()">ğŸ“¤ Export Backup</button>
          <button class="btn btn-amber" onclick="document.getElementById('import-file').click()">ğŸ“¥ Import Backup</button>
          <button class="btn btn-red" onclick="clearAllData()">ğŸ—‘ï¸ Clear All Data</button>
        </div>
        <input type="file" id="import-file" accept=".json" style="display:none" onchange="importData()"/>
      </div>

      <div class="card">
        <h3>ğŸ“Š Statistics</h3>
        <div id="stats-area" style="display:grid;grid-template-columns:repeat(auto-fill,minmax(150px,1fr));gap:14px;margin-top:4px;"></div>
      </div>
    </div>

  </main>
</div>

<div id="admin-toast"></div>

<script>
// â•â•â• DATA HELPERS â•â•â•
function getData(k,d){try{const v=JSON.parse(localStorage.getItem(k));return v!==null?v:d;}catch(e){return d;}}
function setData(k,v){localStorage.setItem(k,JSON.stringify(v));}
function uid(){return Date.now().toString(36)+Math.random().toString(36).slice(2,7);}
const LANG_SHORT={en:'English',fr:'French',ar:'Arabic',es:'Spanish',pt:'Portuguese'};

// â•â•â• LOGIN â•â•â•
function doLogin(){
  const pw=document.getElementById('pw-input').value;
  const stored=localStorage.getItem('adminPw')||'admin123';
  if(pw===stored){
    document.getElementById('login-screen').style.display='none';
    document.getElementById('admin-panel').style.display='flex';
    ensureDefaultTexts();
    refreshAll();
  } else {
    const el=document.getElementById('login-error');
    el.style.display='block';
    setTimeout(()=>el.style.display='none',3500);
  }
}
document.getElementById('pw-input').addEventListener('keydown',e=>{if(e.key==='Enter')doLogin();});
function doLogout(){
  document.getElementById('login-screen').style.display='flex';
  document.getElementById('admin-panel').style.display='none';
  document.getElementById('pw-input').value='';
}

// â•â•â• NAVIGATION â•â•â•
function showPage(p, el){
  document.querySelectorAll('.page').forEach(x=>x.classList.remove('active'));
  document.querySelectorAll('.nav-item').forEach(x=>x.classList.remove('active'));
  document.getElementById('page-'+p).classList.add('active');
  if(el) el.classList.add('active');
  if(p==='settings') renderStats();
  if(p==='texts'){ textFilter='all'; renderTextsAdmin(); }
  if(p==='banners') renderBanners();
  if(p==='affiliates') renderAffiliates();
}

// â•â•â• AFFILIATES â€” SINGLE â•â•â•
function saveAffiliate(){
  const origId=document.getElementById('edit-aff-original-id').value;
  const id=document.getElementById('aff-id').value.trim();
  const promo=document.getElementById('aff-promo').value.trim();
  if(!id){toast('Affiliate ID is required','err');return;}
  if(!promo){toast('Promo Code is required','err');return;}
  let affs=getData('affiliates',[]);
  const obj={
    id, name:document.getElementById('aff-name').value.trim(),
    promoCode:promo,
    playerLink:document.getElementById('aff-player').value.trim(),
    apkLink:document.getElementById('aff-apk').value.trim(),
    iosLink:document.getElementById('aff-ios').value.trim(),
    lang:document.getElementById('aff-lang').value,
  };
  if(origId){
    affs=affs.map(a=>a.id===origId?obj:a);
  } else {
    if(affs.find(a=>a.id.toLowerCase()===id.toLowerCase())){toast('Affiliate ID already exists','err');return;}
    affs.push(obj);
  }
  setData('affiliates',affs);
  clearAffForm();
  renderAffiliates();
  toast('âœ… Affiliate saved!');
}

function clearAffForm(){
  ['aff-id','aff-name','aff-promo','aff-player','aff-apk','aff-ios'].forEach(f=>document.getElementById(f).value='');
  document.getElementById('edit-aff-original-id').value='';
  document.getElementById('aff-form-title').textContent='Add Single Affiliate';
}

function editAffiliate(id){
  const a=getData('affiliates',[]).find(x=>x.id===id);
  if(!a) return;
  document.getElementById('edit-aff-original-id').value=a.id;
  document.getElementById('aff-id').value=a.id;
  document.getElementById('aff-name').value=a.name||'';
  document.getElementById('aff-promo').value=a.promoCode||'';
  document.getElementById('aff-player').value=a.playerLink||'';
  document.getElementById('aff-apk').value=a.apkLink||'';
  document.getElementById('aff-ios').value=a.iosLink||'';
  document.getElementById('aff-lang').value=a.lang||'en';
  document.getElementById('aff-form-title').textContent='Edit Affiliate: '+id;
  window.scrollTo({top:0,behavior:'smooth'});
}

function deleteAffiliate(id){
  if(!confirm('Delete affiliate "'+id+'"?')) return;
  setData('affiliates',getData('affiliates',[]).filter(a=>a.id!==id));
  renderAffiliates();
  toast('Deleted');
}

function renderAffiliates(){
  const affs=getData('affiliates',[]);
  document.getElementById('aff-count').textContent=affs.length;
  const tbody=document.getElementById('aff-tbody');
  if(!affs.length){
    tbody.innerHTML='<tr><td colspan="6" style="text-align:center;color:var(--muted);padding:30px">No affiliates yet. Add one above or import from Excel.</td></tr>';
    return;
  }
  tbody.innerHTML=affs.map(a=>`
    <tr>
      <td><strong style="color:var(--green)">${escHtml(a.id)}</strong></td>
      <td>${escHtml(a.name||'â€”')}</td>
      <td><span class="badge badge-green">${escHtml(a.promoCode)}</span></td>
      <td><span class="badge badge-blue">${LANG_SHORT[a.lang]||a.lang}</span></td>
      <td style="font-size:.75rem">${a.playerLink?`<a href="${escHtml(a.playerLink)}" target="_blank" style="color:var(--muted)">â†— View</a>`:'â€”'}</td>
      <td><div class="btn-row">
        <button class="btn btn-amber btn-sm" onclick="editAffiliate('${escAttr(a.id)}')">âœï¸ Edit</button>
        <button class="btn btn-red btn-sm" onclick="deleteAffiliate('${escAttr(a.id)}')">ğŸ—‘ï¸</button>
      </div></td>
    </tr>`).join('');
}

// â•â•â• AFFILIATES â€” EXCEL IMPORT â•â•â•
let pendingRows=[];

function handleExcelImport(){
  const file=document.getElementById('excel-input').files[0];
  if(!file) return;
  const reader=new FileReader();
  reader.onload=function(e){
    try{
      const wb=XLSX.read(e.target.result,{type:'array'});
      const ws=wb.Sheets[wb.SheetNames[0]];
      const rows=XLSX.utils.sheet_to_json(ws,{header:1,defval:''});
      // detect and skip header row
      const isHeader=(r)=>r[0]&&String(r[0]).toLowerCase().match(/id|affiliate|name/);
      const dataRows=rows.filter((r,i)=>!(i===0&&isHeader(r))).filter(r=>String(r[0]||'').trim());
      pendingRows=dataRows.map(r=>({
        id:String(r[0]||'').trim(),
        name:String(r[1]||'').trim(),
        promoCode:String(r[2]||'').trim(),
        playerLink:String(r[3]||'').trim(),
        apkLink:String(r[4]||'').trim(),
        iosLink:String(r[5]||'').trim(),
        lang:String(r[6]||'en').trim().toLowerCase()||'en',
      })).filter(r=>r.id&&r.promoCode);
      if(!pendingRows.length){toast('No valid data found. Check your columns.','err');return;}
      document.getElementById('excel-count').textContent=`âœ… Found ${pendingRows.length} affiliate(s) ready to import`;
      const preview=pendingRows.slice(0,15).map(r=>`<tr><td>${escHtml(r.id)}</td><td>${escHtml(r.name||'â€”')}</td><td>${escHtml(r.promoCode)}</td><td>${escHtml(r.lang)}</td></tr>`).join('');
      const more=pendingRows.length>15?`<tr><td colspan="4" style="color:var(--muted);text-align:center">...and ${pendingRows.length-15} more rows</td></tr>`:'';
      document.getElementById('excel-preview-table').innerHTML=`<table><thead><tr><th>ID</th><th>Name</th><th>Promo</th><th>Lang</th></tr></thead><tbody>${preview}${more}</tbody></table>`;
      document.getElementById('excel-preview').style.display='block';
    }catch(err){toast('Could not read file: '+err.message,'err');}
  };
  reader.readAsArrayBuffer(file);
}

function confirmExcelImport(){
  let affs=getData('affiliates',[]);
  let added=0,updated=0;
  pendingRows.forEach(r=>{
    const idx=affs.findIndex(a=>a.id.toLowerCase()===r.id.toLowerCase());
    if(idx>=0){affs[idx]=r;updated++;}else{affs.push(r);added++;}
  });
  setData('affiliates',affs);
  cancelExcelImport();
  renderAffiliates();
  toast(`âœ… Imported: ${added} new, ${updated} updated`);
}

function cancelExcelImport(){
  pendingRows=[];
  document.getElementById('excel-input').value='';
  document.getElementById('excel-preview').style.display='none';
}

// â•â•â• BANNERS â•â•â•
let bannerImageData=null;
let promoZone={x:0,y:0,w:0,h:0};
let promoZoneSet=false;
let isDragging=false, dragStart={x:0,y:0};
let displayScale=1;
let currentCanvasRef=null;

function toggleDates(){
  const ev=document.getElementById('ban-type').value==='evergreen';
  document.getElementById('start-grp').style.display=ev?'none':'';
  document.getElementById('end-grp').style.display=ev?'none':'';
}

function loadBannerPreview(){
  const file=document.getElementById('ban-file').files[0];
  if(!file) return;
  const reader=new FileReader();
  reader.onload=function(e){
    bannerImageData=e.target.result;
    const img=new Image();
    img.onload=function(){
      const wrap=document.getElementById('preview-wrap');
      const canvas=document.getElementById('preview-canvas');
      const maxW=Math.max(300, wrap.clientWidth-4);
      displayScale=Math.min(1, maxW/img.width);
      canvas.width=img.width; canvas.height=img.height;
      canvas.style.width=Math.round(img.width*displayScale)+'px';
      canvas.style.height=Math.round(img.height*displayScale)+'px';
      canvas.getContext('2d').drawImage(img,0,0);
      document.getElementById('preview-placeholder').style.display='none';
      canvas.style.display='block';
      wrap.classList.add('has-image');
      document.getElementById('drag-hint').classList.add('show');
      promoZoneSet=false;
      document.getElementById('promo-config-panel').style.display='none';
      document.getElementById('promo-overlay').style.display='none';
      currentCanvasRef=canvas;
      setupDrag(canvas, wrap);
    };
    img.src=e.target.result;
  };
  reader.readAsDataURL(file);
}

function setupDrag(canvas, wrap){
  const overlay=document.getElementById('promo-overlay');

  function getCoords(e){
    const r=canvas.getBoundingClientRect();
    const src=e.touches?e.touches[0]:e;
    const cx=Math.max(0,Math.min(src.clientX-r.left,r.width));
    const cy=Math.max(0,Math.min(src.clientY-r.top,r.height));
    return{x:cx/displayScale,y:cy/displayScale};
  }
  function onStart(e){
    e.preventDefault();
    isDragging=true; dragStart=getCoords(e);
    overlay.style.display='block'; overlay.style.width='0'; overlay.style.height='0';
  }
  function onMove(e){
    if(!isDragging) return; e.preventDefault();
    const cur=getCoords(e);
    const x=Math.min(dragStart.x,cur.x), y=Math.min(dragStart.y,cur.y);
    const w=Math.abs(cur.x-dragStart.x), h=Math.abs(cur.y-dragStart.y);
    promoZone={x:Math.round(x),y:Math.round(y),w:Math.round(w),h:Math.round(h)};
    const cr=canvas.getBoundingClientRect(), wr=wrap.getBoundingClientRect();
    overlay.style.left=(cr.left-wr.left+x*displayScale)+'px';
    overlay.style.top=(cr.top-wr.top+y*displayScale)+'px';
    overlay.style.width=(w*displayScale)+'px';
    overlay.style.height=(h*displayScale)+'px';
  }
  function onEnd(){
    if(!isDragging) return; isDragging=false;
    if(promoZone.w>8&&promoZone.h>8){
      promoZoneSet=true;
      document.getElementById('promo-config-panel').style.display='block';
      document.getElementById('pc-zone-info').value=`X:${promoZone.x} Y:${promoZone.y} W:${promoZone.w} H:${promoZone.h}`;
    }
  }
  // Remove old listeners by replacing node
  const newCanvas=canvas.cloneNode(true);
  canvas.parentNode.replaceChild(newCanvas,canvas);
  currentCanvasRef=newCanvas;
  const img=new Image(); img.onload=()=>newCanvas.getContext('2d').drawImage(img,0,0); img.src=bannerImageData;
  newCanvas.addEventListener('mousedown',onStart);
  newCanvas.addEventListener('touchstart',onStart,{passive:false});
  document.addEventListener('mousemove',onMove);
  document.addEventListener('touchmove',onMove,{passive:false});
  document.addEventListener('mouseup',onEnd);
  document.addEventListener('touchend',onEnd);
}

function saveBanner(){
  if(!bannerImageData){toast('Please upload a banner image first','err');return;}
  const evergreen=document.getElementById('ban-type').value==='evergreen';
  const startDate=document.getElementById('ban-start').value;
  const endDate=document.getElementById('ban-end').value;
  if(!evergreen&&(!startDate||!endDate)){toast('Please set start and end dates','err');return;}
  const pz=promoZoneSet?{
    ...promoZone,
    fontSize:parseInt(document.getElementById('pc-size').value)||28,
    color:document.getElementById('pc-color').value,
  }:null;
  const b={
    id:uid(),
    lang:document.getElementById('ban-lang').value,
    evergreen, startDate:evergreen?null:startDate, endDate:evergreen?null:endDate,
    imageData:bannerImageData, promoConfig:pz, createdAt:Date.now(),
  };
  const banners=getData('banners',[]);
  banners.push(b);
  setData('banners',banners);
  clearBannerForm();
  renderBanners();
  toast('âœ… Banner saved!');
}

function clearBannerForm(){
  document.getElementById('ban-file').value='';
  bannerImageData=null; promoZoneSet=false;
  promoZone={x:0,y:0,w:0,h:0};
  document.getElementById('preview-placeholder').style.display='flex';
  const cv=document.getElementById('preview-canvas');
  cv.style.display='none';
  const ctx=cv.getContext('2d'); ctx.clearRect(0,0,cv.width,cv.height);
  document.getElementById('promo-overlay').style.display='none';
  document.getElementById('promo-config-panel').style.display='none';
  document.getElementById('drag-hint').classList.remove('show');
  document.getElementById('preview-wrap').classList.remove('has-image');
}

function renderBanners(){
  const banners=getData('banners',[]);
  document.getElementById('ban-count').textContent=banners.length;
  const tbody=document.getElementById('ban-tbody');
  if(!banners.length){tbody.innerHTML='<tr><td colspan="6" style="text-align:center;color:var(--muted);padding:30px">No banners uploaded yet.</td></tr>';return;}
  tbody.innerHTML=banners.map(b=>`
    <tr>
      <td><img src="${b.imageData}" style="height:52px;width:84px;object-fit:cover;border-radius:6px;border:1px solid var(--border)"/></td>
      <td><span class="badge ${b.evergreen?'badge-amber':'badge-green'}">${b.evergreen?'â™¾ï¸ Evergreen':'ğŸ“… Dated'}</span></td>
      <td>${LANG_SHORT[b.lang]||b.lang}</td>
      <td style="font-size:.78rem;color:var(--muted)">${b.evergreen?'No expiry':(b.startDate+' â†’ '+b.endDate)}</td>
      <td>${b.promoConfig?'<span class="badge badge-green">âœ“ Set</span>':'<span style="color:var(--muted);font-size:.78rem">None</span>'}</td>
      <td><button class="btn btn-red btn-sm" onclick="deleteBanner('${b.id}')">ğŸ—‘ï¸ Delete</button></td>
    </tr>`).join('');
}

function deleteBanner(id){
  if(!confirm('Delete this banner?')) return;
  setData('banners',getData('banners',[]).filter(b=>b.id!==id));
  renderBanners();
  toast('Deleted');
}

// â•â•â• TEXTS â•â•â•
let textFilter='all';

function saveText(){
  const editId=document.getElementById('edit-text-id').value;
  const content=document.getElementById('txt-content').value.trim();
  const lang=document.getElementById('txt-lang').value;
  if(!content){toast('Caption text is required','err');return;}
  let texts=getData('texts',[]);
  const obj={id:editId||uid(),lang,content};
  if(editId){texts=texts.map(t=>t.id===editId?obj:t);}
  else texts.push(obj);
  setData('texts',texts);
  clearTextForm();
  renderTextsAdmin();
  toast('âœ… Caption saved!');
}

function clearTextForm(){
  document.getElementById('txt-content').value='';
  document.getElementById('edit-text-id').value='';
  document.getElementById('txt-form-title').textContent='Add New Caption';
  document.getElementById('txt-form-icon').textContent='â•';
  document.getElementById('txt-edit-note').style.display='none';
}

function editText(id){
  const t=getData('texts',[]).find(x=>x.id===id);
  if(!t) return;
  document.getElementById('edit-text-id').value=t.id;
  document.getElementById('txt-lang').value=t.lang;
  document.getElementById('txt-content').value=t.content;
  document.getElementById('txt-form-title').textContent='Editing Caption';
  document.getElementById('txt-form-icon').textContent='âœï¸';
  document.getElementById('txt-edit-note').style.display='inline';
  window.scrollTo({top:0,behavior:'smooth'});
}

function deleteText(id){
  if(!confirm('Delete this caption?')) return;
  setData('texts',getData('texts',[]).filter(t=>t.id!==id));
  renderTextsAdmin();
  toast('Deleted');
}

function filterTexts(lang,el){
  textFilter=lang;
  document.querySelectorAll('.filter-tab').forEach(t=>t.classList.remove('active'));
  if(el) el.classList.add('active');
  renderTextsAdmin();
}

function renderTextsAdmin(){
  const texts=getData('texts',[]);
  const filtered=textFilter==='all'?texts:texts.filter(t=>t.lang===textFilter);
  document.getElementById('txt-count').textContent=texts.length;
  const cont=document.getElementById('texts-admin-list');
  if(!filtered.length){cont.innerHTML='<div style="text-align:center;color:var(--muted);padding:30px">No captions found. Add one above.</div>';return;}
  cont.innerHTML=filtered.map((t,i)=>`
    <div class="text-admin-card">
      <div class="card-top">
        <div style="display:flex;align-items:center;gap:8px">
          <span class="badge badge-green">${LANG_SHORT[t.lang]||t.lang}</span>
          <span style="font-size:.72rem;color:var(--muted)">Caption #${i+1}</span>
        </div>
        <div class="btn-row">
          <button class="btn btn-amber btn-sm" onclick="editText('${t.id}')">âœï¸ Edit</button>
          <button class="btn btn-red btn-sm" onclick="deleteText('${t.id}')">ğŸ—‘ï¸ Delete</button>
        </div>
      </div>
      <pre>${escHtml(t.content)}</pre>
    </div>`).join('');
}

// â•â•â• SETTINGS â•â•â•
function changePassword(){
  const cur=document.getElementById('cur-pw').value;
  const nw=document.getElementById('new-pw').value;
  const conf=document.getElementById('conf-pw').value;
  const stored=localStorage.getItem('adminPw')||'admin123';
  if(cur!==stored){toast('Current password is incorrect','err');return;}
  if(!nw||nw.length<4){toast('New password must be at least 4 characters','err');return;}
  if(nw!==conf){toast('Passwords do not match','err');return;}
  localStorage.setItem('adminPw',nw);
  ['cur-pw','new-pw','conf-pw'].forEach(f=>document.getElementById(f).value='');
  toast('âœ… Password updated!');
}

function exportData(){
  const d={affiliates:getData('affiliates',[]),banners:getData('banners',[]),texts:getData('texts',[]),exportedAt:new Date().toISOString()};
  const blob=new Blob([JSON.stringify(d,null,2)],{type:'application/json'});
  const a=document.createElement('a'); a.href=URL.createObjectURL(blob);
  a.download='megapari-backup-'+new Date().toISOString().slice(0,10)+'.json'; a.click();
  toast('âœ… Backup exported!');
}

function importData(){
  const file=document.getElementById('import-file').files[0];
  if(!file) return;
  const r=new FileReader();
  r.onload=function(e){
    try{
      const d=JSON.parse(e.target.result);
      if(d.affiliates) setData('affiliates',d.affiliates);
      if(d.banners) setData('banners',d.banners);
      if(d.texts) setData('texts',d.texts);
      refreshAll();
      toast('âœ… Data imported!');
    }catch(err){toast('Invalid backup file','err');}
  };
  r.readAsText(file);
}

function clearAllData(){
  if(!confirm('âš ï¸ Delete ALL affiliates, banners, and captions? This cannot be undone.')) return;
  if(!confirm('FINAL CONFIRM â€” delete everything?')) return;
  ['affiliates','banners','texts'].forEach(k=>localStorage.removeItem(k));
  refreshAll();
  toast('All data cleared');
}

function renderStats(){
  const a=getData('affiliates',[]).length;
  const b=getData('banners',[]);
  const t=getData('texts',[]);
  const ev=b.filter(x=>x.evergreen).length;
  const byL={en:0,fr:0,ar:0,es:0,pt:0};
  t.forEach(x=>{if(byL[x.lang]!==undefined)byL[x.lang]++;});
  const sc=(v,l,c)=>`<div style="background:var(--card2);border:1px solid var(--border);border-radius:10px;padding:16px;text-align:center"><div style="font-size:1.8rem;font-weight:700;color:${c};font-family:'Bebas Neue',sans-serif">${v}</div><div style="font-size:.7rem;color:var(--muted);text-transform:uppercase;letter-spacing:1px;margin-top:4px">${l}</div></div>`;
  document.getElementById('stats-area').innerHTML=
    sc(a,'Affiliates','var(--green)')+sc(b.length,'Total Banners','var(--amber)')+
    sc(ev,'Evergreen','var(--green)')+sc(t.length,'Total Captions','#90caf9')+
    Object.entries(byL).map(([l,n])=>sc(n,LANG_SHORT[l]+' Captions','var(--muted)')).join('');
}

// â•â•â• HELPERS â•â•â•
function toast(msg,type){
  const t=document.getElementById('admin-toast');
  t.textContent=msg; t.style.background=type==='err'?'var(--red)':'var(--green)'; t.style.color=type==='err'?'#fff':'#000';
  t.classList.add('show'); setTimeout(()=>t.classList.remove('show'),2800);
}
function escHtml(s){const d=document.createElement('div');d.textContent=String(s||'');return d.innerHTML;}
function escAttr(s){return String(s||'').replace(/'/g,"\\'");}
function refreshAll(){renderAffiliates();renderBanners();renderTextsAdmin();}

// â•â•â• DEFAULT TEXTS â€” 7 PER LANGUAGE â•â•â•
function getDefaultTexts(){
  const en=[
    {id:'e1',lang:'en',content:"âš½ğŸ”¥ BIG MATCH ENERGY STARTS HERE!\nTurn every game into real winnings with Megapari. Odds are hot, payouts are fast, and the action never stops.\nğŸ¯ Register now: {{Player link}}\nğŸ“² Android APK: {{apk link}}\nğŸ iOS app: {{iOS link}}\nğŸ Use promo code: {{Promo code}}\nDon't just watch football â€” profit from it."},
    {id:'e2',lang:'en',content:"Smart bettors don't chase luck â€” they use the right platform.\nMegapari gives you competitive odds, live betting, and instant withdrawals so you stay ahead of the game.\nğŸ‘‰ Join here: {{Player link}}\nğŸ“¥ Android: {{apk link}}\nğŸ“± iOS: {{iOS link}}\nğŸ’° Promo code: {{Promo code}}\nBet smarter. Win faster."},
    {id:'e3',lang:'en',content:"ğŸš¨ TODAY'S GAMES = TODAY'S PROFITS\nIf you're watching football without betting on Megapari, you're missing money.\nSign up now and activate your bonus instantly.\nğŸ”— Register: {{Player link}}\nğŸ“² Download APK: {{apk link}}\nğŸ iOS: {{iOS link}}\nğŸ Promo code: {{Promo code}}\nDon't sit out the action."},
    {id:'e4',lang:'en',content:"Our winning community is growing daily âš½ğŸ’¬\nJoin thousands of football fans turning predictions into cash with Megapari.\nStart here: {{Player link}}\nAndroid app: {{apk link}}\niOS app: {{iOS link}}\nPromo code: {{Promo code}}\nYou watch the games anyway â€” you might as well get paid."},
    {id:'e5',lang:'en',content:"Trusted odds. Fast payouts. Real results.\nMegapari is built for serious football bettors who want performance, not excuses.\nRegister: {{Player link}}\nAPK download: {{apk link}}\niOS download: {{iOS link}}\nUse code: {{Promo code}}\nPlay like a pro."},
    {id:'e6',lang:'en',content:"Weekend football hits different when you've got money on the line ğŸ˜âš½\nMake every goal count with Megapari.\nSign up: {{Player link}}\nAndroid: {{apk link}}\niOS: {{iOS link}}\nPromo code: {{Promo code}}\nFun to watch. Better to win."},
    {id:'e7',lang:'en',content:"ğŸ Bonus unlocked. All that's missing is you.\nCreate your Megapari account and activate your promo reward today.\nğŸ‘‰ Register: {{Player link}}\nğŸ“² APK: {{apk link}}\nğŸ iOS: {{iOS link}}\nPromo code: {{Promo code}}\nClaim it. Bet it. Win it."},
  ];
  const fr=[
    {id:'f1',lang:'fr',content:"âš½ğŸ”¥ L'Ã‰NERGIE DES GRANDS MATCHS COMMENCE ICI!\nTransformez chaque match en vrais gains avec Megapari. Les cotes sont allÃ©chantes, les paiements rapides, et l'action ne s'arrÃªte jamais.\nğŸ¯ Inscrivez-vous: {{Player link}}\nğŸ“² APK Android: {{apk link}}\nğŸ App iOS: {{iOS link}}\nğŸ Code promo: {{Promo code}}\nNe regardez plus le football â€” profitez-en."},
    {id:'f2',lang:'fr',content:"Les parieurs intelligents ne courent pas aprÃ¨s la chance â€” ils utilisent la bonne plateforme.\nMegapari vous offre des cotes compÃ©titives, les paris en direct et des retraits instantanÃ©s.\nğŸ‘‰ Rejoignez ici: {{Player link}}\nğŸ“¥ Android: {{apk link}}\nğŸ“± iOS: {{iOS link}}\nğŸ’° Code promo: {{Promo code}}\nPariez plus intelligemment. Gagnez plus vite."},
    {id:'f3',lang:'fr',content:"ğŸš¨ LES MATCHS D'AUJOURD'HUI = LES PROFITS D'AUJOURD'HUI\nSi vous regardez le football sans parier sur Megapari, vous perdez de l'argent.\nInscrivez-vous maintenant et activez votre bonus instantanÃ©ment.\nğŸ”— S'inscrire: {{Player link}}\nğŸ“² APK: {{apk link}}\nğŸ iOS: {{iOS link}}\nğŸ Code promo: {{Promo code}}\nNe ratez pas l'action."},
    {id:'f4',lang:'fr',content:"Notre communautÃ© de gagnants grandit chaque jour âš½ğŸ’¬\nRejoignez des milliers de fans de football qui transforment leurs pronostics en argent avec Megapari.\nCommencez ici: {{Player link}}\nApp Android: {{apk link}}\nApp iOS: {{iOS link}}\nCode promo: {{Promo code}}\nVous regardez les matchs de toute faÃ§on â€” autant Ãªtre payÃ©."},
    {id:'f5',lang:'fr',content:"Des cotes fiables. Des paiements rapides. De vrais rÃ©sultats.\nMegapari est conÃ§u pour les parieurs sÃ©rieux qui veulent de la performance.\nS'inscrire: {{Player link}}\nAPK: {{apk link}}\niOS: {{iOS link}}\nCode: {{Promo code}}\nJouez comme un pro."},
    {id:'f6',lang:'fr',content:"Le football du week-end est diffÃ©rent quand vous avez de l'argent en jeu ğŸ˜âš½\nFaites compter chaque but avec Megapari.\nS'inscrire: {{Player link}}\nAndroid: {{apk link}}\niOS: {{iOS link}}\nCode promo: {{Promo code}}\nAmusant Ã  regarder. Meilleur Ã  gagner."},
    {id:'f7',lang:'fr',content:"ğŸ Bonus dÃ©bloquÃ©. Il ne manque que vous.\nCrÃ©ez votre compte Megapari et activez votre rÃ©compense promo aujourd'hui.\nğŸ‘‰ S'inscrire: {{Player link}}\nğŸ“² APK: {{apk link}}\nğŸ iOS: {{iOS link}}\nCode promo: {{Promo code}}\nRÃ©clamez-le. Pariez dessus. Gagnez-le."},
  ];
  const ar=[
    {id:'a1',lang:'ar',content:"âš½ğŸ”¥ Ø·Ø§Ù‚Ø© Ø§Ù„Ù…Ø¨Ø§Ø±Ø§Ø© Ø§Ù„ÙƒØ¨ÙŠØ±Ø© ØªØ¨Ø¯Ø£ Ù‡Ù†Ø§!\nØ­ÙˆÙ‘Ù„ ÙƒÙ„ Ù…Ø¨Ø§Ø±Ø§Ø© Ø¥Ù„Ù‰ Ø£Ø±Ø¨Ø§Ø­ Ø­Ù‚ÙŠÙ‚ÙŠØ© Ù…Ø¹ Megapari. Ø§Ù„Ø£ÙˆØ¶Ø§Ø¹ Ø±Ø§Ø¦Ø¹Ø© ÙˆØ§Ù„Ù…Ø¯ÙÙˆØ¹Ø§Øª Ø³Ø±ÙŠØ¹Ø© ÙˆØ§Ù„Ø¥Ø«Ø§Ø±Ø© Ù„Ø§ ØªØªÙˆÙ‚Ù.\nğŸ¯ Ø³Ø¬Ù‘Ù„ Ø§Ù„Ø¢Ù†: {{Player link}}\nğŸ“² ØªØ·Ø¨ÙŠÙ‚ Ø£Ù†Ø¯Ø±ÙˆÙŠØ¯: {{apk link}}\nğŸ ØªØ·Ø¨ÙŠÙ‚ iOS: {{iOS link}}\nğŸ ÙƒÙˆØ¯ Ø§Ù„ØªØ±ÙˆÙŠØ¬: {{Promo code}}\nÙ„Ø§ ØªÙƒØªÙÙ Ø¨Ù…Ø´Ø§Ù‡Ø¯Ø© ÙƒØ±Ø© Ø§Ù„Ù‚Ø¯Ù… â€” Ø§Ø³ØªÙØ¯ Ù…Ù†Ù‡Ø§."},
    {id:'a2',lang:'ar',content:"Ø§Ù„Ù…Ø±Ø§Ù‡Ù†ÙˆÙ† Ø§Ù„Ø£Ø°ÙƒÙŠØ§Ø¡ Ù„Ø§ ÙŠØ·Ø§Ø±Ø¯ÙˆÙ† Ø§Ù„Ø­Ø¸ â€” ÙŠØ³ØªØ®Ø¯Ù…ÙˆÙ† Ø§Ù„Ù…Ù†ØµØ© Ø§Ù„ØµØ­ÙŠØ­Ø©.\nÙŠÙ…Ù†Ø­Ùƒ Megapari Ø£ÙØ¶Ù„ Ø§Ù„Ø£ÙˆØ¶Ø§Ø¹ ÙˆØ§Ù„Ø±Ù‡Ø§Ù† Ø§Ù„Ù…Ø¨Ø§Ø´Ø± ÙˆØ³Ø­Ø¨Ù‹Ø§ ÙÙˆØ±ÙŠÙ‹Ø§.\nğŸ‘‰ Ø§Ù†Ø¶Ù… Ù‡Ù†Ø§: {{Player link}}\nğŸ“¥ Ø£Ù†Ø¯Ø±ÙˆÙŠØ¯: {{apk link}}\nğŸ“± iOS: {{iOS link}}\nğŸ’° ÙƒÙˆØ¯ Ø§Ù„ØªØ±ÙˆÙŠØ¬: {{Promo code}}\nØ±Ø§Ù‡Ù† Ø¨Ø°ÙƒØ§Ø¡. Ø§ÙÙˆØ² Ø¨Ø³Ø±Ø¹Ø©."},
    {id:'a3',lang:'ar',content:"ğŸš¨ Ù…Ø¨Ø§Ø±ÙŠØ§Øª Ø§Ù„ÙŠÙˆÙ… = Ø£Ø±Ø¨Ø§Ø­ Ø§Ù„ÙŠÙˆÙ…!\nØ¥Ø°Ø§ ÙƒÙ†Øª ØªØ´Ø§Ù‡Ø¯ ÙƒØ±Ø© Ø§Ù„Ù‚Ø¯Ù… Ø¯ÙˆÙ† Ù…Ø±Ø§Ù‡Ù†Ø© Ø¹Ù„Ù‰ Megapari ÙØ£Ù†Øª ØªØ®Ø³Ø± Ø§Ù„Ù…Ø§Ù„.\nØ³Ø¬Ù‘Ù„ Ø§Ù„Ø¢Ù† ÙˆÙØ¹Ù‘Ù„ Ù…ÙƒØ§ÙØ£ØªÙƒ ÙÙˆØ±Ù‹Ø§.\nğŸ”— Ø§Ù„ØªØ³Ø¬ÙŠÙ„: {{Player link}}\nğŸ“² ØªØ­Ù…ÙŠÙ„ APK: {{apk link}}\nğŸ iOS: {{iOS link}}\nğŸ ÙƒÙˆØ¯ Ø§Ù„ØªØ±ÙˆÙŠØ¬: {{Promo code}}\nÙ„Ø§ ØªØºØ¨ Ø¹Ù† Ø§Ù„Ø¥Ø«Ø§Ø±Ø©."},
    {id:'a4',lang:'ar',content:"Ù…Ø¬ØªÙ…Ø¹Ù†Ø§ Ø§Ù„ÙØ§Ø¦Ø² ÙŠØªÙ†Ø§Ù…Ù‰ ÙŠÙˆÙ…ÙŠÙ‹Ø§ âš½ğŸ’¬\nØ§Ù†Ø¶Ù… Ø¥Ù„Ù‰ Ø¢Ù„Ø§Ù Ù…Ø­Ø¨ÙŠ ÙƒØ±Ø© Ø§Ù„Ù‚Ø¯Ù… Ø§Ù„Ø°ÙŠÙ† ÙŠØ­ÙˆÙ‘Ù„ÙˆÙ† ØªÙˆÙ‚Ø¹Ø§ØªÙ‡Ù… Ø¥Ù„Ù‰ Ù†Ù‚ÙˆØ¯ Ù…Ø¹ Megapari.\nØ§Ø¨Ø¯Ø£ Ù‡Ù†Ø§: {{Player link}}\nØªØ·Ø¨ÙŠÙ‚ Ø£Ù†Ø¯Ø±ÙˆÙŠØ¯: {{apk link}}\nØªØ·Ø¨ÙŠÙ‚ iOS: {{iOS link}}\nÙƒÙˆØ¯ Ø§Ù„ØªØ±ÙˆÙŠØ¬: {{Promo code}}\nØ£Ù†Øª ØªØ´Ø§Ù‡Ø¯ Ø§Ù„Ù…Ø¨Ø§Ø±ÙŠØ§Øª Ø¹Ù„Ù‰ Ø£ÙŠ Ø­Ø§Ù„ â€” ÙÙ„Ù…Ø§Ø°Ø§ Ù„Ø§ ØªØ­ØµÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø§Ù„ØŸ"},
    {id:'a5',lang:'ar',content:"Ø£ÙˆØ¶Ø§Ø¹ Ù…ÙˆØ«ÙˆÙ‚Ø©. Ù…Ø¯ÙÙˆØ¹Ø§Øª Ø³Ø±ÙŠØ¹Ø©. Ù†ØªØ§Ø¦Ø¬ Ø­Ù‚ÙŠÙ‚ÙŠØ©.\nMegapari Ù…ØµÙ…Ù… Ù„Ù„Ù…Ø±Ø§Ù‡Ù†ÙŠÙ† Ø§Ù„Ø¬Ø§Ø¯ÙŠÙ† Ø§Ù„Ø°ÙŠÙ† ÙŠØ±ÙŠØ¯ÙˆÙ† Ø§Ù„Ø£Ø¯Ø§Ø¡ Ù„Ø§ Ø§Ù„Ø£Ø¹Ø°Ø§Ø±.\nØ§Ù„ØªØ³Ø¬ÙŠÙ„: {{Player link}}\nØªØ­Ù…ÙŠÙ„ APK: {{apk link}}\nØªØ­Ù…ÙŠÙ„ iOS: {{iOS link}}\nØ§Ø³ØªØ®Ø¯Ù… Ø§Ù„ÙƒÙˆØ¯: {{Promo code}}\nØ§Ù„Ø¹Ø¨ ÙƒØ§Ù„Ù…Ø­ØªØ±ÙÙŠÙ†."},
    {id:'a6',lang:'ar',content:"ÙƒØ±Ø© Ù‚Ø¯Ù… Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ ØªØµØ¨Ø­ Ø£ÙƒØ«Ø± Ø¥Ø«Ø§Ø±Ø© Ø¹Ù†Ø¯Ù…Ø§ ØªÙƒÙˆÙ† Ø£Ù…ÙˆØ§Ù„Ùƒ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø­Ùƒ ğŸ˜âš½\nØ§Ø¬Ø¹Ù„ ÙƒÙ„ Ù‡Ø¯Ù ÙŠÙØ­Ø³Ø¨ Ù…Ø¹ Megapari.\nØ³Ø¬Ù‘Ù„: {{Player link}}\nØ£Ù†Ø¯Ø±ÙˆÙŠØ¯: {{apk link}}\niOS: {{iOS link}}\nÙƒÙˆØ¯ Ø§Ù„ØªØ±ÙˆÙŠØ¬: {{Promo code}}\nÙ…Ù…ØªØ¹ Ù„Ù„Ù…Ø´Ø§Ù‡Ø¯Ø©. Ø£ÙØ¶Ù„ Ù„Ù„ÙÙˆØ²."},
    {id:'a7',lang:'ar',content:"ğŸ ØªÙ… ÙØªØ­ Ø§Ù„Ù…ÙƒØ§ÙØ£Ø©. ÙƒÙ„ Ù…Ø§ ÙŠÙ†Ù‚Øµ Ù‡Ùˆ Ø£Ù†Øª.\nØ£Ù†Ø´Ø¦ Ø­Ø³Ø§Ø¨ Megapari Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ ÙˆÙØ¹Ù‘Ù„ Ù…ÙƒØ§ÙØ£Ø© Ø§Ù„ØªØ±ÙˆÙŠØ¬ Ø§Ù„ÙŠÙˆÙ….\nğŸ‘‰ Ø§Ù„ØªØ³Ø¬ÙŠÙ„: {{Player link}}\nğŸ“² APK: {{apk link}}\nğŸ iOS: {{iOS link}}\nÙƒÙˆØ¯ Ø§Ù„ØªØ±ÙˆÙŠØ¬: {{Promo code}}\nØ§Ø·Ù„Ø¨Ù‡Ø§. Ø±Ø§Ù‡Ù† Ø¹Ù„ÙŠÙ‡Ø§. Ø§ÙÙˆØ² Ø¨Ù‡Ø§."},
  ];
  const es=[
    {id:'s1',lang:'es',content:"âš½ğŸ”¥ Â¡LA ENERGÃA DE LOS GRANDES PARTIDOS EMPIEZA AQUÃ!\nConvierte cada partido en ganancias reales con Megapari. Las cuotas son increÃ­bles, los pagos rÃ¡pidos y la acciÃ³n nunca para.\nğŸ¯ RegÃ­strate: {{Player link}}\nğŸ“² APK Android: {{apk link}}\nğŸ App iOS: {{iOS link}}\nğŸ CÃ³digo promo: {{Promo code}}\nNo solo mires el fÃºtbol â€” gana con Ã©l."},
    {id:'s2',lang:'es',content:"Los apostadores inteligentes no persiguen la suerte â€” usan la plataforma correcta.\nMegapari te ofrece cuotas competitivas, apuestas en vivo y retiros instantÃ¡neos.\nğŸ‘‰ Ãšnete aquÃ­: {{Player link}}\nğŸ“¥ Android: {{apk link}}\nğŸ“± iOS: {{iOS link}}\nğŸ’° CÃ³digo promo: {{Promo code}}\nApuesta mÃ¡s inteligente. Gana mÃ¡s rÃ¡pido."},
    {id:'s3',lang:'es',content:"ğŸš¨ LOS PARTIDOS DE HOY = LAS GANANCIAS DE HOY\nSi estÃ¡s viendo fÃºtbol sin apostar en Megapari, estÃ¡s perdiendo dinero.\nRegÃ­strate ahora y activa tu bono al instante.\nğŸ”— Registro: {{Player link}}\nğŸ“² APK: {{apk link}}\nğŸ iOS: {{iOS link}}\nğŸ CÃ³digo promo: {{Promo code}}\nNo te quedes fuera de la acciÃ³n."},
    {id:'s4',lang:'es',content:"Nuestra comunidad ganadora crece cada dÃ­a âš½ğŸ’¬\nÃšnete a miles de aficionados al fÃºtbol que convierten sus predicciones en dinero con Megapari.\nEmpieza aquÃ­: {{Player link}}\nApp Android: {{apk link}}\nApp iOS: {{iOS link}}\nCÃ³digo promo: {{Promo code}}\nDe todas formas ves los partidos â€” Â¿por quÃ© no cobrar por ello?"},
    {id:'s5',lang:'es',content:"Cuotas confiables. Pagos rÃ¡pidos. Resultados reales.\nMegapari estÃ¡ construido para apostadores serios que quieren rendimiento, no excusas.\nRegÃ­strate: {{Player link}}\nAPK: {{apk link}}\niOS: {{iOS link}}\nCÃ³digo: {{Promo code}}\nJuega como un profesional."},
    {id:'s6',lang:'es',content:"El fÃºtbol del fin de semana es diferente cuando tienes dinero en juego ğŸ˜âš½\nHaz que cada gol cuente con Megapari.\nRegÃ­strate: {{Player link}}\nAndroid: {{apk link}}\niOS: {{iOS link}}\nCÃ³digo promo: {{Promo code}}\nDivertido de ver. Mejor ganarlo."},
    {id:'s7',lang:'es',content:"ğŸ Bono desbloqueado. Solo faltas tÃº.\nCrea tu cuenta Megapari y activa tu recompensa promo hoy.\nğŸ‘‰ RegÃ­strate: {{Player link}}\nğŸ“² APK: {{apk link}}\nğŸ iOS: {{iOS link}}\nCÃ³digo promo: {{Promo code}}\nReclÃ¡malo. Apuesta. Gana."},
  ];
  const pt=[
    {id:'p1',lang:'pt',content:"âš½ğŸ”¥ A ENERGIA DOS GRANDES JOGOS COMEÃ‡A AQUI!\nTransforme cada jogo em ganhos reais com a Megapari. As odds sÃ£o Ã³timas, os pagamentos rÃ¡pidos e a aÃ§Ã£o nunca para.\nğŸ¯ Registre-se: {{Player link}}\nğŸ“² APK Android: {{apk link}}\nğŸ App iOS: {{iOS link}}\nğŸ CÃ³digo promo: {{Promo code}}\nNÃ£o apenas assista ao futebol â€” lucre com ele."},
    {id:'p2',lang:'pt',content:"Apostadores inteligentes nÃ£o correm atrÃ¡s da sorte â€” usam a plataforma certa.\nA Megapari oferece odds competitivas, apostas ao vivo e saques instantÃ¢neos.\nğŸ‘‰ Junte-se: {{Player link}}\nğŸ“¥ Android: {{apk link}}\nğŸ“± iOS: {{iOS link}}\nğŸ’° CÃ³digo promo: {{Promo code}}\nAposte mais inteligente. Ganhe mais rÃ¡pido."},
    {id:'p3',lang:'pt',content:"ğŸš¨ OS JOGOS DE HOJE = OS LUCROS DE HOJE\nSe vocÃª estÃ¡ assistindo futebol sem apostar na Megapari, estÃ¡ perdendo dinheiro.\nRegistre-se agora e ative seu bÃ´nus instantaneamente.\nğŸ”— Registro: {{Player link}}\nğŸ“² APK: {{apk link}}\nğŸ iOS: {{iOS link}}\nğŸ CÃ³digo promo: {{Promo code}}\nNÃ£o fique de fora da aÃ§Ã£o."},
    {id:'p4',lang:'pt',content:"Nossa comunidade vencedora cresce diariamente âš½ğŸ’¬\nJunte-se a milhares de fÃ£s de futebol transformando previsÃµes em dinheiro com a Megapari.\nComece aqui: {{Player link}}\nApp Android: {{apk link}}\nApp iOS: {{iOS link}}\nCÃ³digo promo: {{Promo code}}\nVocÃª assiste aos jogos de qualquer forma â€” por que nÃ£o ser pago?"},
    {id:'p5',lang:'pt',content:"Odds confiÃ¡veis. Pagamentos rÃ¡pidos. Resultados reais.\nA Megapari foi construÃ­da para apostadores sÃ©rios que querem desempenho, nÃ£o desculpas.\nRegistre-se: {{Player link}}\nAPK: {{apk link}}\niOS: {{iOS link}}\nCÃ³digo: {{Promo code}}\nJogue como um profissional."},
    {id:'p6',lang:'pt',content:"O futebol do fim de semana Ã© diferente quando vocÃª tem dinheiro em jogo ğŸ˜âš½\nFaÃ§a cada gol contar com a Megapari.\nRegistre-se: {{Player link}}\nAndroid: {{apk link}}\niOS: {{iOS link}}\nCÃ³digo promo: {{Promo code}}\nDivertido de assistir. Melhor ganhar."},
    {id:'p7',lang:'pt',content:"ğŸ BÃ´nus desbloqueado. SÃ³ falta vocÃª.\nCrie sua conta Megapari e ative sua recompensa promo hoje.\nğŸ‘‰ Registro: {{Player link}}\nğŸ“² APK: {{apk link}}\nğŸ iOS: {{iOS link}}\nCÃ³digo promo: {{Promo code}}\nReivindique. Aposte. Ganhe."},
  ];
  return [...en,...fr,...ar,...es,...pt];
}

function ensureDefaultTexts(){
  const existing=getData('texts',[]);
  if(!existing||existing.length===0){
    setData('texts',getDefaultTexts());
  }
}
</script>
</body>
</html>
